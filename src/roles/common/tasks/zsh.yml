---
- name: "Install zsh"
  become: true
  apt:
    name: "{{ item }}"
  with_items:
    - zsh
- name: "Check out the zsh configuration repository"
  git:
    repo: https://scheleaap@github.com/scheleaap/zsh-config.git
    dest: /home/{{ user_username }}/.zsh
- name: "Configure the zsh configuration repository"
  git_config:
    repo: /home/{{ user_username }}/.zsh
    name: "{{ item.name }}"
    value: "{{ item.value }}"
    scope: local
  with_items:
    - { name: "user.name", value: "{{ zsh_git_user_name }}" }
    - { name: "user.email", value: "{{ zsh_git_user_email }}" }
- name: "Set up .zshrc"
  file:
    state: link
    src: /home/{{ user_username }}/.zsh/.zshrc
    dest: /home/{{ user_username }}/.zshrc
- name: "Configure zsh as the default shell"
  become: true
  user:
    name: "{{ user_username }}"
    shell: /usr/bin/zsh